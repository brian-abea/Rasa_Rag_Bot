version: "3.1"

rules:
  - rule: Respond to greeting
    steps:
      - intent: greet
      - action: utter_greet

  - rule: Say goodbye
    steps:
      - intent: goodbye
      - action: utter_goodbye

  - rule: Handle affirmation
    steps:
      - intent: affirm
      - action: utter_affirm

  - rule: Respond to bot challenge
    steps:
      - intent: bot_challenge
      - action: utter_iamabot

  - rule: Respond to explicit RAG queries
    steps:
      - intent: rag_query
      - action: action_rag_search

  - rule: Respond to smartphone financing inquiry
    steps:
      - intent: inquire_smartphone_financing
      - action: utter_inquire_smartphone_financing

  - rule: Explain why phone is locked
    steps:
      - intent: ask_why_phone_locked
      - action: utter_why_phone_locked

  - rule: Handle locked phone despite payment
    steps:
      - intent: phone_locked_but_paid
      - action: utter_phone_locked_but_paid

  - rule: Handle payment process
    steps:
      - intent: make_payment
      - action: utter_make_payment

  - rule: Request phone number for verification before checking asset status
    condition:
      - slot_was_set:
          - phone_verified: false
    steps:
      - intent: check_asset_status
      - action: utter_ask_for_phone_number

  - rule: Immediately check asset status if already verified
    condition:
      - slot_was_set:
          - phone_verified: true
    steps:
      - intent: check_asset_status
      - action: action_check_asset_status

  - rule: Catch all for Fallback
    steps:
      - intent: nlu_fallback
      - action: action_fallback

  - rule: Welcome user on session start
    steps:
      - action: action_session_start

  - rule: User asks for help
    steps:
      - intent: help
      - action: action_help